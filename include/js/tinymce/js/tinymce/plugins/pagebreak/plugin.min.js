!function(){var c=tinymce.util.Tools.resolve("tinymce.PluginManager"),h=tinymce.util.Tools.resolve("tinymce.Env"),d=function(){return'<img src="'+h.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'},k=function(a){var b=a.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e"),c=new RegExp(b.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi");a.on("BeforeSetContent",function(a){a.content=a.content.replace(c,d())});a.on("PreInit",function(){a.serializer.addNodeFilter("img",
function(c){for(var e,d,g=c.length;g--;)if((d=(e=c[g]).attr("class"))&&-1!==d.indexOf("mce-pagebreak")){var f=e.parent;a.schema.getBlockElements()[f.name]&&a.getParam("pagebreak_split_block",!1)?(f.type=3,f.value=b,f.raw=!0,e.remove()):(e.type=3,e.value=b,e.raw=!0)}})})},l=function(a){a.addCommand("mcePageBreak",function(){a.settings.pagebreak_split_block?a.insertContent("<p>"+d()+"</p>"):a.insertContent(d())})},m=function(a){a.on("ResolveName",function(b){"IMG"===b.target.nodeName&&a.dom.hasClass(b.target,
"mce-pagebreak")&&(b.name="pagebreak")})};c.add("pagebreak",function(a){l(a);a.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"});a.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"});k(a);m(a)})}();
