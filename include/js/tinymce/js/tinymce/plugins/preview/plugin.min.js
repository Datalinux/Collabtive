!function(){var f=tinymce.util.Tools.resolve("tinymce.PluginManager"),g=tinymce.util.Tools.resolve("tinymce.Env"),h=tinymce.util.Tools.resolve("tinymce.util.Tools"),l=function(a){var d="",c=a.dom.encode,b=a.getParam("content_style",""),d=d+('<base href="'+c(a.documentBaseURI.getURI())+'">');b&&(d+='<style type="text/css">'+b+"</style>");h.each(a.contentCSS,function(b){d+='<link type="text/css" rel="stylesheet" href="'+c(a.documentBaseURI.toAbsolute(b))+'">'});b=a.settings.body_id||"tinymce";-1!==
b.indexOf("=")&&(b=(b=a.getParam("body_id","","hash"))[a.id]||b);var e=a.settings.body_class||"";-1!==e.indexOf("=")&&(e=(e=a.getParam("body_class","","hash"))[a.id]||"");var k=a.settings.directionality?' dir="'+a.settings.directionality+'"':"";return"<!DOCTYPE html><html><head>"+d+'</head><body id="'+c(b)+'" class="mce-content-body '+c(e)+'"'+c(k)+">"+a.getContent()+'<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);\x3c/script> </body></html>'},
m=function(a){var d=!g.ie,c='<iframe src="javascript:\'\'" frameborder="0"'+(d?' sandbox="allow-scripts"':"")+"></iframe>",b=parseInt(a.getParam("plugin_preview_width","650"),10),e=parseInt(a.getParam("plugin_preview_height","500"),10);a.windowManager.open({title:"Preview",width:b,height:e,html:c,buttons:{text:"Close",onclick:function(a){a.control.parent().parent().close()}},onPostRender:function(b){var c=b.control.getEl("body").firstChild;b=l(a);d?c.src="data:text/html;charset=utf-8,"+encodeURIComponent(b):
(c=c.contentWindow.document,c.open(),c.write(b),c.close())}})},n=function(a){a.addCommand("mcePreview",function(){m(a)})};f.add("preview",function(a){n(a);a.addButton("preview",{title:"Preview",cmd:"mcePreview"});a.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})})}();
